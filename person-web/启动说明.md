# 个人网站系统启动说明

## 项目结构

- `person-web-service`：后端SpringBoot应用
- `person-web-ui`：前端React应用
- `run.bat`：启动前后端应用的脚本
- `start-frontend.bat`：仅启动前端应用的脚本
- `check-env.bat`：检查开发环境配置的脚本
- `check-scripts.bat`：脚本自检工具（新增）

## 快速启动指南

### 1. 运行脚本自检

在开始之前，建议先运行脚本自检工具，确保环境和文件都正确配置：

```
cd person-web
check-scripts.bat
```

### 2. 检查环境要求

确保您的系统已经安装以下软件：
- Node.js（版本16+）
- npm
- Java JDK（版本8+）

您可以运行`check-env.bat`脚本来检查环境配置：

```
cd person-web
check-env.bat
```

### 3. 构建后端服务

首先，请确保已经构建了后端服务：

```
cd ..
build-app.bat
```

构建成功后，会生成JAR文件：`person-web/person-web-service/target/person-web-service-0.0.1-SNAPSHOT.jar`

### 4. 启动应用

有两种方式可以启动应用：

#### 方式一：同时启动前后端（推荐）

在`person-web`目录下运行`run.bat`脚本：

```
cd person-web
run.bat
```

该脚本会：
1. 检查Java环境是否正确
2. 查找并验证后端JAR包是否存在
3. 启动后端SpringBoot服务
4. 等待后端服务完全启动
5. 检查并安装前端依赖
6. 启动前端React服务

#### 方式二：分别启动

如果您已经启动了后端服务，只需要启动前端：

```
cd person-web
start-frontend.bat
```

这个脚本现在增加了：
1. Node.js版本兼容性检查
2. 更强大的react-scripts安装和错误处理
3. 安装依赖时使用--legacy-peer-deps参数以避免兼容性问题

### 5. 访问应用

成功启动后，您可以通过以下地址访问应用：
- 后端API：http://localhost:8080/api
- 前端页面：http://localhost:3000

## 常见问题解决

### 1. "react-scripts"未识别的错误

如果启动前端时出现`'react-scripts' is not recognized`错误：

1. 使用start-frontend.bat脚本，它现在有内置的修复功能
2. 或手动运行以下命令：
   ```
   npm uninstall react-scripts
   npm install react-scripts@5.0.1 --save --force
   ```

### 2. 依赖安装失败

如果安装依赖失败，可以尝试：

1. 清除npm缓存：`npm cache clean --force`
2. 使用兼容模式安装依赖：`npm install --legacy-peer-deps`
3. 使用强制安装：`npm install --force`
4. 切换到国内镜像：`npm config set registry https://registry.npmmirror.com`

### 3. 后端无法启动

如果后端服务无法启动：

1. 确保已成功构建后端JAR包
2. 检查Java环境是否正确配置
3. 查看端口8080是否被占用，可以通过以下命令检查：
   ```
   netstat -ano | findstr :8080
   ```
4. 使用check-scripts.bat脚本验证所有配置

### 4. 前后端连接问题

如果前端无法连接后端API：

1. 确保后端服务已成功启动且API可访问
2. 检查前端代理配置是否正确
3. 确认CORS配置允许前端域名访问
4. 在浏览器中直接访问http://localhost:8080/api测试后端是否响应

## 自定义配置

### 后端配置

后端配置文件位于：`person-web-service/src/main/resources/application.properties`

主要配置项包括：
- 服务器端口
- 数据库连接设置
- 日志级别

### 前端配置

前端配置位于：`person-web-ui/src/setupProxy.js`和环境变量文件中

您可以根据需要修改API代理设置和环境变量。

## 脚本文件说明

### build-app.bat

后端构建脚本，现在增加了：
- Maven路径自动检测
- 更详细的构建过程反馈
- 构建结果验证

### run.bat

前后端启动脚本，现在增加了：
- Java环境检查
- 更多JAR包路径检测选项
- 延长后端启动等待时间
- 后端健康检查

### start-frontend.bat

前端启动脚本，现在增加了：
- Node.js版本兼容性检查
- 增强的依赖安装选项
- react-scripts安装问题的多种修复方案

### check-env.bat

环境检查脚本，已修复特殊字符转义问题

### check-scripts.bat

新增的脚本自检工具，可以：
- 检查所有必要脚本是否存在
- 验证JAR包是否存在
- 检查环境变量配置
- 检查项目目录结构
- 提供自检结果摘要 